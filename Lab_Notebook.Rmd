---
title: "Turner Lab Notebook"
author: "Callum Malcolm"
output:
  pdf_document: default
  toc: true
  toc_float: true
  html_document: default
---

# Tuesday 02-05-2023
1. Thawed N2, RBL1, and RAMOS into T75 flasks  
  Note: N2 and RBL1 flaskes seeded with feeders

# Wednesday 03-05-2023
1. Splitting cells

| Cell Line | Cells/mL | Cells/mL Seeded| CS volume |Final Volume|Last day split| P number|
| :-------: | :------: | :-------------:| :--------:| :---------:|:------------:|:-------:|
| N2        | 8.93x10^5^| 3x10^5^.      | 6.71 mL   | 12 mL      |Tues 02-05-23 | 2       |
| RBL1      | 7.73x10^5^| 3x10^5^.      | 7.76 mL   | 12 mL      |Tues 02-05-23 | 2       |

2. Expanded N2-Barcodes to T175  

3. Seeded feeders into 96-well
    a. Diluted feeders to 3.2x10^4^ cells/mL
    b. Add 100$\mu$L cell suspension to each well
    



# Monday 19-06-2023  

1. Splitting cells
    - Split N2/RBL1/JIRE
    - Added 10 mL media to BLLW  
      * Lots of dead cells observed
2. EC50 - ID:  
    - Cylophosphamide EC50 for N2 and RBL1  
  
```{r EC50 2 Cell Line Plate Map, echo=FALSE, message=FALSE, warning=FALSE}
library(tidyverse)
library(ggforce)
library(scales)

pbs <- "PBS"
C1 <- "N2"
C2 <- "RBL1"
EC50_ID <- "EC50_230619_plate1"

dil_ID = matrix(c(pbs,pbs,pbs,pbs,pbs,pbs,pbs,pbs,pbs,pbs,pbs,pbs,
                  pbs, "3","3","3","2","2","2","1","1","1",pbs,pbs,
                  pbs,"6","6","6","5","5","5","4","4","4",pbs,pbs,
                  pbs,"Control","Control","Control","8","8","8","7","7","7",pbs,pbs,
                  pbs,"3","3","3","2","2","2","1","1","1",pbs,pbs,
                  pbs,"6","6","6","5","5","5","4","4","4",pbs,pbs,
                  pbs,"Control","Control","Control","8","8","8","7","7","7",pbs,pbs,
                  pbs,pbs,pbs,pbs,pbs,pbs,pbs,pbs,pbs,pbs,pbs,pbs), ncol = 12, nrow = 8, byrow = TRUE)

drug_list = matrix(c(pbs,pbs,pbs,pbs,pbs,pbs,pbs,pbs,pbs,pbs,pbs,pbs,
                     pbs, C1,C1,C1,C1,C1,C1,C1,C1,C1,pbs,pbs,
                     pbs, C1,C1,C1,C1,C1,C1,C1,C1,C1,pbs,pbs,
                     pbs,C1,C1,C1,C1,C1,C1,C1,C1,C1,pbs,pbs,
                     pbs, C2,C2,C2,C2,C2,C2,C2,C2,C2,pbs,pbs,
                     pbs,C2,C2,C2,C2,C2,C2,C2,C2,C2,pbs,pbs,
                     pbs,C2,C2,C2,C2,C2,C2,C2,C2,C2,pbs,pbs,
                     pbs,pbs,pbs,pbs,pbs,pbs,pbs,pbs,pbs,pbs,pbs,pbs), ncol = 12, nrow = 8, byrow = TRUE)



df1 <- as.data.frame(drug_list)
df2 <- as.data.frame(dil_ID)
df1 <- df1 %>% 
  mutate(row = 1:8) %>% 
  pivot_longer(-row, names_to = "col", values_to = "value") %>%
  mutate(col = as.integer(str_remove(col, "V"))) %>%
  mutate(well = paste0(LETTERS[row], col))

df2 <- df2 %>% 
  mutate(row = 1:8) %>% 
  pivot_longer(-row, names_to = "col", values_to = "value") %>%
  mutate(col = as.integer(str_remove(col, "V"))) %>%
  mutate(well = paste0(LETTERS[row], col))

#Plot
p <- ggplot(data = df1) + 
  geom_circle(aes(x0 = col, y0 = row, r = 0.45, fill = value))
p <- p + coord_equal()
p <- p + 
  scale_x_continuous(breaks = 1:12, expand = expansion(mult = c(0.01, 0.01)), trans = reverse_trans()) +
  scale_y_continuous(breaks = 1:8, labels = LETTERS[1:8], expand = expansion(mult = c(0.01, 0.01)), trans = reverse_trans())
p <- p + geom_text(data = df2, aes(x = col, y = row, label = paste0(value)), size = 2,)
p <- p +
  labs(title = "96 Well Plate Map", subtitle = EC50_ID, x = "Col", y = "Row") + 
  theme_bw() + 
  theme(panel.grid.major = element_blank(),
        panel.grid.minor = element_blank())
print(p)

```

Drug Dilutions
```{r EC50 Serial Dilutions, echo=FALSE, message=FALSE, warning=FALSE}
library(dplyr)
library(kableExtra)
options(scipen = 1, digits = 2)

# Set conditions
drug_name <- "Cyclophosphamide"
initial_concentration <- 20
dilution_factor <- 10
num_dilutions <- 8
concentration_units <- "uM"

library(dplyr)
library(kableExtra)
# Function to calculate serial dilutions and create a table
serial_dilutions_table <- function(drug_name, initial_concentration, dilution_factor, num_dilutions, conc_units) {
  concentrations <- numeric(num_dilutions + 1)
  concentrations[1] <- initial_concentration
  
  # Create a data frame to store the dilution information
  dilution_table <- data.frame(
    Drug = character(num_dilutions + 1),
    Dilution = integer(num_dilutions + 1),
    Concentration = numeric(num_dilutions + 1),
    Units = character(num_dilutions + 1)
  )
  
  for (i in 1:num_dilutions) {
    concentrations[i + 1] <- concentrations[i] / dilution_factor
  }
  
  # Populate the dilution table
  dilution_table$Drug <- drug_name
  dilution_table$Dilution <- c(0:num_dilutions + 1)
  dilution_table$Concentration <- concentrations
  dilution_table$Starting_Concentration <- concentrations / 0.001
  dilution_table$Units <- conc_units
  
  return(dilution_table)
}

dilution_table <- serial_dilutions_table(drug_name, initial_concentration, dilution_factor, num_dilutions, concentration_units)
dilution_table %>% 
  kbl()

```


# Tuesday 20-06-2023




